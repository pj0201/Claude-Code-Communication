# 宿泊アプリ コードレビュー依頼

## レビュー対象

宿泊施設向けのデジタルチェックインアプリ（React + TypeScript + Vite）

**プロジェクトパス**: `/home/planj/host-friendly-checkin/`

---

## レビュー重点ポイント

### ⚠️ 重要な注意
- **UIの見た目は後で変更予定**なので、視覚的デザインは軽くで構いません
- **UX（ユーザー体験）とバックエンド設計**を重点的にレビューしてください

---

## プロジェクト概要

### 目的
民泊・ホテルのデジタルチェックインシステム

### 主要機能
1. **宿泊者情報入力** (Profile.tsx)
2. **本人確認（eKYC）** (Ekyc.tsx)
3. **規約同意** (Terms.tsx)
4. **追加サービス選択** (Extras.tsx)
5. **決済処理** (Stripe統合)
6. **管理画面** (Admin.tsx)
   - 企業情報登録
   - 決済機能設定
   - 備品販売管理
   - 予約サイト連携設定

### 技術スタック
- **フロントエンド**: React 18 + TypeScript + Vite
- **UI**: Tailwind CSS + shadcn/ui
- **バックエンド**: Supabase（想定）
- **決済**: Stripe
- **ルーティング**: React Router

---

## レビュー依頼項目

### 1. アーキテクチャ・設計

**チェックポイント**:
- [ ] コンポーネント設計の適切性
- [ ] 状態管理の方法（useState/Context/外部ライブラリ）
- [ ] ファイル・ディレクトリ構造
- [ ] 責務の分離（ビジネスロジック vs プレゼンテーション）
- [ ] スケーラビリティ（機能追加時の拡張性）

**質問**:
- より良い構造はありますか？
- リファクタリングすべき箇所は？

---

### 2. UX（ユーザー体験）

**チェックポイント**:
- [ ] チェックインフローの直感性
- [ ] エラーハンドリングの適切性
- [ ] ローディング状態の管理
- [ ] フォームバリデーション
- [ ] モバイル対応（レスポンシブ）
- [ ] 多言語対応（i18n）の実装方法
- [ ] アクセシビリティ（a11y）

**想定ユーザー**:
- 外国人観光客（英語・中国語・韓国語）
- 年配者（スマホ操作に不慣れ）
- 急いでいるビジネス客

**質問**:
- UXで改善すべき点は？
- より直感的にするための提案は？

---

### 3. バックエンド連携

**現状**:
- Supabaseクライアント設定済み (`src/integrations/supabase/`)
- 型定義あり (`types.ts`)
- 実際のDB操作は未実装

**チェックポイント**:
- [ ] Supabase統合の設計
- [ ] データフロー（フロント ↔ バックエンド）
- [ ] エラーハンドリング
- [ ] セキュリティ（認証・認可）
- [ ] データ永続化の戦略

**質問**:
- バックエンド実装前に修正すべき設計は？
- データモデルの提案は？

---

### 4. 決済処理（Stripe）

**実装ファイル**:
- `src/components/payment/StripeProvider.tsx`
- `src/components/payment/StripePaymentForm.tsx`
- `src/components/payment/PaymentMethodSelector.tsx`

**チェックポイント**:
- [ ] Stripe統合の適切性
- [ ] PCI DSS準拠
- [ ] エラーハンドリング
- [ ] 3D Secure対応
- [ ] セキュリティベストプラクティス

**質問**:
- 決済処理で見落としているリスクは？
- より安全な実装方法は？

---

### 5. セキュリティ

**チェックポイント**:
- [ ] 個人情報の取り扱い
- [ ] XSS対策
- [ ] CSRF対策
- [ ] 環境変数の管理
- [ ] APIキーの保護
- [ ] 入力値のサニタイズ

**質問**:
- セキュリティホールはありますか？
- 実装前に対策すべき脆弱性は？

---

### 6. パフォーマンス

**チェックポイント**:
- [ ] 不要な再レンダリング
- [ ] メモ化（useMemo/useCallback）の適切性
- [ ] 画像最適化
- [ ] コード分割（React.lazy）
- [ ] バンドルサイズ

**質問**:
- パフォーマンス改善の余地は？
- 最適化すべき重い処理は？

---

### 7. エラーハンドリング・ロギング

**チェックポイント**:
- [ ] try-catchの適切性
- [ ] エラーメッセージの分かりやすさ
- [ ] ユーザーへのフィードバック
- [ ] エラーログの記録
- [ ] エラーバウンダリの実装

**質問**:
- エラーハンドリングで改善すべき点は？
- デバッグしやすくするための提案は？

---

### 8. コード品質

**チェックポイント**:
- [ ] TypeScriptの型定義
- [ ] コードの可読性
- [ ] 命名規則
- [ ] コメントの適切性
- [ ] DRY原則（重複コード）
- [ ] SOLID原則

**質問**:
- リファクタリングすべきアンチパターンは？
- コードの保守性を上げるには？

---

### 9. テスト戦略

**現状**: テスト未実装

**質問**:
- どのようなテストを優先すべきですか？
- テストしやすい設計になっていますか？

---

### 10. 今後の拡張性

**予定機能**:
- 予約メール自動取り込み
- 部屋別予約状況ダッシュボード
- 外部予約サイト連携（API/メール）
- ハウスキーピング管理

**質問**:
- これらの機能追加に備えて、今修正すべき設計は？
- 拡張しやすいアーキテクチャへの提案は？

---

## 主要ファイルリスト

### ページコンポーネント
- `src/pages/Index.tsx` - トップページ
- `src/pages/Welcome.tsx` - ようこそ画面
- `src/pages/Profile.tsx` - 宿泊者情報入力
- `src/pages/Ekyc.tsx` - 本人確認
- `src/pages/Terms.tsx` - 規約同意
- `src/pages/Access.tsx` - アクセス情報
- `src/pages/Extras.tsx` - 追加サービス
- `src/pages/Admin.tsx` - 管理画面

### 機能コンポーネント
- `src/components/Layout.tsx` - レイアウト
- `src/components/ProgressBar.tsx` - 進捗表示
- `src/components/LanguageSwitch.tsx` - 言語切り替え
- `src/components/admin/MerchandiseManager.tsx` - 備品管理
- `src/components/payment/` - 決済関連

### バックエンド連携
- `src/integrations/supabase/client.ts` - Supabaseクライアント
- `src/integrations/supabase/types.ts` - 型定義

### 設定ファイル
- `vite.config.ts` - Vite設定
- `tsconfig.json` - TypeScript設定
- `tailwind.config.ts` - Tailwind設定

---

## 期待するレビュー形式

### 1. 総合評価
- 現在の設計の良い点
- 主要な問題点
- 総合的な改善提案

### 2. 優先度別の指摘

**🔴 Critical（実装前に必須）**:
- セキュリティリスク
- アーキテクチャの根本的問題

**🟠 High（早めに対応）**:
- UXの大きな問題
- パフォーマンス問題

**🟡 Medium（改善推奨）**:
- リファクタリング候補
- コード品質向上

**🟢 Low（余裕があれば）**:
- 細かい改善
- ベストプラクティス

### 3. 具体的な修正案
- Before/Afterコード例
- 実装手順
- 参考リンク

---

## 補足情報

### 対象ユーザー
- 日本国内の民泊・ホテル運営者
- 宿泊客（日本人・外国人）

### 規模
- 小〜中規模施設（10〜100室）
- 月間1,000〜10,000チェックイン想定

### デプロイ予定
- Vercel or Netlify
- Supabase (バックエンド)

---

## レビュー依頼

上記の観点で、コードを包括的にレビューしてください。

特に以下を重視してください:
1. **UX**: 直感的か、分かりやすいか
2. **バックエンド設計**: データフロー、セキュリティ
3. **拡張性**: 今後の機能追加に耐えられるか

よろしくお願いします！

---

**作成者**: Claude Code Worker3
**作成日**: 2025-10-07
